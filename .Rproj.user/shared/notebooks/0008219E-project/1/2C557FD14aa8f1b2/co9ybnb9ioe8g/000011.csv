"0",""
"0","# Calculate Gini Coefficient"
"0","gini_coefficient <- function(income, weights) {"
"0","  sorted_indices <- order(income)"
"0","  sorted_income <- income[sorted_indices]"
"0","  sorted_weights <- weights[sorted_indices]"
"0","  "
"0","  cum_weights <- cumsum(sorted_weights) / sum(sorted_weights)"
"0","  cum_income <- cumsum(sorted_income * sorted_weights) / sum(sorted_income * sorted_weights)"
"0","  "
"0","  gini <- 1 - sum((cum_income[-length(cum_income)] + cum_income[-1]) * diff(cum_weights))"
"0","  return(gini)"
"0","}"
"0",""
"0","income <- data$income"
"0","weights <- data$fweight"
"0","gini <- gini_coefficient(income, weights)"
"0",""
"0","# Filter data for females"
"0","female_data <- data %>% filter(sex == ""Female"")"
"0","female_income <- female_data$income"
"0","female_weights <- female_data$fweight"
"0",""
"0","# Calculate weighted mean and standard error for females"
"0","weighted_mean <- sum(female_income * female_weights) / sum(female_weights)"
"0","weighted_variance <- sum(((female_income - weighted_mean)^2) * female_weights) / sum(female_weights)"
"0","weighted_se <- sqrt(weighted_variance / nrow(female_data))"
