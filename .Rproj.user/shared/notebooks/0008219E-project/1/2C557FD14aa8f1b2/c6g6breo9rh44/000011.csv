"0",""
"0","# 95% confidence interval"
"0","ci_lower <- weighted_mean - qnorm(0.975) * weighted_se"
"0","ci_upper <- weighted_mean + qnorm(0.975) * weighted_se"
"0","confidence_interval <- c(ci_lower, ci_upper)"
"0",""
"0","# Print results"
"0","print(paste(""Gini Coefficient:"", round(gini, 3)))"
"1","[1]"
"1"," ""Gini Coefficient: 0.75"""
"1","
"
"0","print(paste(""95% Confidence Interval for Female Mean Income: ["", round(ci_lower, 2), "", "", round(ci_upper, 2), ""]"", sep = """"))"
"1","[1]"
"1"," ""95% Confidence Interval for Female Mean Income: [1885.17, 2242.65]"""
"1","
"
"0","# Plot Lorenz Curve"
"0","sorted_indices <- order(income)"
"0","sorted_income <- income[sorted_indices]"
"0","sorted_weights <- weights[sorted_indices]"
"0",""
"0","cum_weights <- cumsum(sorted_weights) / sum(sorted_weights)"
"0","cum_income <- cumsum(sorted_income * sorted_weights) / sum(sorted_income * sorted_weights)"
"0",""
"0","lorenz_df <- data.frame(cum_weights, cum_income)"
"0",""
"0","ggplot(lorenz_df, aes(x = cum_weights, y = cum_income)) +"
"0","  geom_line(color = ""blue"", size = 1) +"
"0","  geom_abline(intercept = 0, slope = 1, linetype = ""dashed"", color = ""gray"") +"
"0","  labs(title = ""Lorenz Curve of Income Distribution"","
"0","       x = ""Cumulative Share of Population"","
"0","       y = ""Cumulative Share of Income"") +"
"0","  theme_minimal()"
