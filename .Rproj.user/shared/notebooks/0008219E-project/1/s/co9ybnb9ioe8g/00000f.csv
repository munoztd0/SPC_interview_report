"0","# Calculate Gini coefficient"
"0","gini <- function(x, w = NULL) {"
"0","  if (is.null(w)) w <- rep(1, length(x))"
"0","  x <- x[order(x)]"
"0","  w <- w[order(x)]"
"0","  N <- sum(w)"
"0","  C <- cumsum(w)"
"0","  G <- sum(w * (2 * C - N - w)) / (N * sum(x))"
"0","  return(G)"
"0","}"
"0","gini_value <- gini(data$income, data$fweight)"
"0","data.frame(Metric = ""Gini Coefficient"", Value = round(gini_value, 4)) %>% kable()"
