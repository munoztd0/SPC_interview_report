"0","mean_income_data <- data %>%"
"0","  group_by(province, sex) %>%"
"0","  summarize("
"0","    Mean_Income = mean(income, na.rm = TRUE),"
"0","    SE = sd(income, na.rm = TRUE) / sqrt(n())"
"0","  )"
"0",""
"0","plot_ly() %>%"
"0","  add_trace("
"0","    data = mean_income_data,"
"0","    x = ~province,"
"0","    y = ~Mean_Income,"
"0","    color = ~sex,"
"0","    type = ""bar"","
"0","    colors = viridis(2),"
"0","    opacity = 0.7,  # Added transparency"
"0","    error_y = list("
"0","      type = ""data"","
"0","      array = ~SE * 1.96,"
"0","      visible = TRUE,"
"0","      color = ""#2c3e50"","
"0","      thickness = 1,"
"0","      width = 3"
"0","    )"
"0","  ) %>%"
"0","  layout("
"0","    title = ""Mean Income by Province and Gender"","
"0","    barmode = ""group"","
"0","    xaxis = list(title = ""Province""),"
"0","    yaxis = list("
"0","      title = ""Mean Income"","
"0","      tickformat = ""$,"","
"0","      hoverformat = ""$,.2f"""
"0","    ),"
"0","    showlegend = TRUE"
"0","  )"
